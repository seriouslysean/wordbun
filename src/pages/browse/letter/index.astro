---
import DescriptionText from '~components/DescriptionText.astro';
import Heading from '~components/Heading.astro';
import WordSection from '~components/WordSection.astro';
import Layout from '~layouts/Layout.astro';
import { getPageMetadata } from '~astro-utils/page-metadata.ts';
import { STRUCTURED_DATA_TYPE } from '~astro-utils/schema-utils.ts';
import { getLetterUrl } from '~astro-utils/url-utils';
import { getWordsFromCollection, groupWordsByLetter } from '~astro-utils/word-data-utils';
import { t } from '~utils/i18n-utils';

const allWords = await getWordsFromCollection();
const letterGroups = Object.entries(groupWordsByLetter(allWords)).map(([letter, words]) => ({
  letter: letter.toUpperCase(),
  words,
}));
const { title, description, secondaryText } = getPageMetadata(Astro.url.pathname);
---
<Layout title={title} description={description} structuredDataType={STRUCTURED_DATA_TYPE.WORD_LIST}>
  <Heading text={title} secondaryText={secondaryText} />
  <DescriptionText text={description} />
  {letterGroups.map(({ letter, words }) => (
    <WordSection title={t('words.words_starting_with', { letter })} href={getLetterUrl(letter)} words={words} />
  ))}
</Layout>
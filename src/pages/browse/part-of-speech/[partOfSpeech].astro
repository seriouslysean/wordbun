---
import DescriptionText from '~components/DescriptionText.astro';
import Heading from '~components/Heading.astro';
import WordSection from '~components/WordSection.astro';
import Layout from '~layouts/Layout.astro';
import { getPageMetadata } from '~astro-utils/page-metadata.ts';
import { STRUCTURED_DATA_TYPE } from '~astro-utils/schema-utils.ts';
import { getWordsFromCollection, groupWordsByPartOfSpeech } from '~astro-utils/word-data-utils';

export async function getStaticPaths() {
  const allWords = await getWordsFromCollection();
  const partOfSpeechGroups = groupWordsByPartOfSpeech(allWords);

  return Object.entries(partOfSpeechGroups).map(([partOfSpeech, words]) => ({
    params: { partOfSpeech },
    props: { words, partOfSpeech },
  }));
}

const { words } = Astro.props;
const { title, description, secondaryText } = getPageMetadata(Astro.url.pathname);
---
<Layout title={title} description={description} structuredDataType={STRUCTURED_DATA_TYPE.WORD_LIST}>
  <Heading level={1} text={title} secondaryText={secondaryText} />
  <DescriptionText text={description} />
  <WordSection words={words} columns={2} />
</Layout>